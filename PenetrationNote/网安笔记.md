# ############winodws###############

# 什么是虚拟化



通过虚拟化技术将一台计算机虚拟为多台逻辑计算机。在一台计算机上同时运行多个逻辑计算机。

# 传统架构与虚拟架构的区别是什么

传统架构是基于物理服务器的,而虚拟机架构是基于虚拟机的。 传统架构指的是使用物理服务器来构建和部署应用程序的方式。 虚拟机架构是基于虚拟机技术的应用程序开发和部署方式。



# 什么是vsphere

vSphere 是 VMware 的虚拟化平台，可将数据中心转换为包 括 CPU、存储和网络资源的聚合计算基础架构。vSphere 将这些基础架构作为一个统一的运行环境进行管理，并提供工具来管理加入该环境的数据中心。

vSphere 的两个核心组件：ESXi 是用于创建并运行虚拟机和虚拟设备的虚拟化平台；vCenter Server 是一项服务，用于管理网络中连接的多个主机，并将主机资源池化。



# 远程桌面连接技术

> 连接方法

法一：通过远程桌面通信协议RDP，使用远程桌面功能连接；

法二：通过终端服务网页访问，使用浏览器连接远程计算机

> 用户应具备什么 权限才能利用连接远程计算机？

允许远程访问权限

> 使用哪个命令能连接远程桌面？

mstsc /v： ip：port





# 用户账户

> 与使用者关联的用户帐户 

Administrator（管理员用户） 

Guest（来宾用户）

> 与Windows组件关联的用户帐户

SYSTEM（本地系统） 

LOCAL SERVICE（本地服务） 

NETWORK SERVICE（网络服务）



# 权限

> 权限的管理有四项基本原则：

拒绝优于允许原则：拒绝ip对项目访问

权限最小化原则：  能不配权限就不配

累加原则： 用户权限随组进行权限类加

权限继承性原则：用户访问子文件夹同等



# 常用的文件系统

FAT 

NTFS 

EXT

> NTFS 优点

提高磁盘读写性能、磁盘利用率（压缩），可靠性（加密文件系统）



> NTFS权限的分类？

完全控制、修改、读取执行、读取、写入、特殊



# 文件服务器

通过C/S结构提供资源的集中存储和访问

C/S结构：资源集中放置在服务器（Server）中 ，用户直接访问服务器获取资源

对等网：网络内用户权限相同

> 文件服务器功能

集中化管理、内容控制、高可靠性、搜索服务



# DHCP

作用：为网络中计算机自动分配TCP/IP参数的协议 

> 分类

自动分配：分配到一个IP地址后永久使用

手动分配：由DHCP服务器管理员专门指定IP地址

动态分配：使用完后释放该IP，供其它客户机使用

> 租约过程

客户机请求IP

服务器响应

客户机选择IP

服务器确定租约

> DHCP意义

• 避免IP冲突 

• 提高了IP地址的利用率 

> 安装DHCP服务之前的规划

服务器具有静态IP地址

确定DHCP服务器分发给客户机的IP地址范围

为客户机确定正确的子网掩码

确定DHCP服务器不向客户机分发的IP地址

决定IP地址的租用期限

> 租约更新

IP地址的租期达到50%后，须重新更新租期

客户端重启，发送带有IP地址的DHCP Request请求包



# DNS

早期使用Hosts文件解析域名：主机名称重复，主机维护困难

现在DNS：分布式、层次性

---

> 域名空间结构

根域、顶级域（组织域，国家域）、二级域名

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240306154648391.png" alt="image-20240306154648391" style="zoom:80%;" />

FQDN=主机名.DNS后缀

---

> DNS服务器分类

主要名称服务器：存放该区域中相关设置的DNS服务器

辅助名称服务器：从其他服务器中复制数据，数据为副本无法修改

主控名称服务器：提供趋于数据复制的DNS服务器

Cache-Only名称服务器：将查询到的数据保存在高速缓存中

---

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240306154824733.png" alt="image-20240306154824733" style="zoom: 67%;" />

主要：首先查询的是hosts文件，在去首选dns

> 从查询方式分类

递归查询：客户端得到结果只能是成功或失败

迭代查询：DNS服务器如有客户机请求数据则返回正确地址，没有请求数据则返回一个指针

> 从查询内容分类

正向查询：由域名查找IP地址

反向查询：由IP地址查找域名

---

> 提供DNS服务的必要条件

有固定的IP地址

安装并启动DNS服务

有区域文件，配置转发器，或者配置根提示



# FTP

FTP是一种应用层协议，采用C/S结构设计，结构中心为FTP服务器，为用户提供上传和下载文件的服务

> 常用FTP程序有哪些？

客户端：命令行工具、www浏览器、专用图形工具（FlashFXP）

服务端：FTP发布服务、Serv-U

---





# 日志

> 日志分析

查看哪些主机的日志（筛选对象） ——> 在哪里查看（取 样） ——> 怎么查看（研判分析） ——> 做好记录、保留 关键截图 ——> 上报并处置事件闭环。

> 一般我们主要查看的三类日志是：

应用程序日志、安全日志、系统日志

![image-20240306155444452](https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240306155444452.png)



> 暴力破解账密日志

攻击者通过暴力破解的方式入侵系统，不论是否成功，在日志中会留下入侵痕迹，所以事件id为4624和 4625的事件是首当其冲的关注点。需要留意日志中的SubjectUserNameIpAddress。

> 账号管理日志

 Windows中日志中与账号创建有关的事件ID：4720, 4722, 4724,4738。攻击者攻陷一台Windows 主机后，可能会创建后门账号、隐藏账号。 

> 远程桌面登录日志

1149：用户认证成功    

21：远程桌面服务：会话登录成功 

24：远程桌面服务：会话已断开连接 

25：远程桌面服务：会话重新连接成功

---





# 备份

将数据的副本按一定策略储存到安全的地方

> 备份分类

完整备份  ： 所选数据全部备份 、耗时较长 

增量备份：只备份新添加或有改动的数据 、 备份速度快 、降低系统整体性能 

自定义备份： 针对不同磁盘选择不同的备份方式



# 域

> 域和工作组

工作组：网络资源少、分散管理、适合于小型网络；

域：将网络中的资源逻辑上组织到一起集中管理、适合于大中型网络

> 活动目录

是一个目录数据库，存储着整个Windows网络中的用户账号、 组、计算机、共享文件夹等对象的相关信息

优点：集中管理、便捷的网络资源访问、可扩展性；

> 域和域控制器

域：活动目录的一种实现形式、活动目录中最核心的管理单位，由域控制器和成员计算机组成；

域控制器：安装了活动目录的一台计算机，域管理员可以控制每个域用户的行为；

> 域逻辑结构

单域，网络中只建立了一个域； 

域树：具有连续的名称空间（xxx.com）的多个域，树形结构

域林：由一个或多个没有形成连续名称空间的域树组成

> 域物理结构

站点：对应高速稳定的IP子网，如企业内部的局域网

域控制器：域控制器保存了活动目录信息的副本

---

> 安装域控DC的必备条件

本地管理员权限、NTFS分区、静态IP地址、有足够的可用磁盘空间；

> 客户机加入域的条件

计算机IP地址和DNS配置正确、确保该计算机和域控制器互相连通

> 额外域控制器的好处

提供容错：在一台域控制器出现故障的情况下，仍可提供域服务；

负载均衡：多台域控制器同时分担用户的审核工作，加快审核速度；

易于用户的连接和访问：分支机构用户通过额外域控制器登录域，提高登录速度

> 安全组和通讯组有什么区别？

安全组：为用户设置访问权限

通讯组：用于电子邮件通信，包含联系人和用户帐户；

> 本地域组、全局组和通用组有什么区别？

• 本地域组：针对本域的资源创建本地域组，适用范围：本域

• 全局组：管理需要进行日常维护的目录对象 ，适用范围：整林及信任域

• 通用组 ：身份信息记录在全局编录中，查询速度快 ，适用范围：整林及信任域

> 组策略的优点

减小管理成本（只需设置一次）、减小用户单独配置错误的可能性；

> 客户机登录域问题

客户机联系域时出现问题，一般是由DNS解析失败造成



> 组策略应用顺序

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240306164601115.png" alt="image-20240306164601115" style="zoom:67%;" />



# 证书



> PKI 公钥基础设施

通过使用公钥技术和数字签名来确保信息安全，由公钥加密技术、数字证书、CA、RA组成；

PKI体系能够实现的功能有：身份验证、数据完整性、数据机密性、操作的不可否认性；

PKI协议：SSL（认证用户和服务器）、HTTPS（通信）、IPSec（VPN解决方案）

> 什么是数据加密？

发送方使用接收方的公钥加密数据，接收方使用自己的私钥解密数据；

数据加密能保证所发送数据的机密性

> 什么是数字签名？

发送方对原始数据执行HASH算法得到摘要值，然后用自己私钥加密摘要值，最后将加密的摘要值与原始数据发送给接收方；

数字签名保证数据完整性、身份验证和不可否认

> CA的作用是什么？

CA是证书颁发机构，CA的核心功能是颁发和管理数字证书；

作用：处理证书申请、发放证书、更新证书、数字证书的查询、撤销

> 什么是证书

证书用于保证密钥的合法性

证书的主体可以是用户、计算机、服务等

数字证书包含信息：使用者的公钥值、标识信息、有效期、颁发者标识信息、颁发者的数字签名；

数字证书由权威公正的第三方机构即CA签发

> 简述证书的发放过程？

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240306161838951.png" alt="image-20240306161838951" style="zoom:67%;" />





# ################network################

# IP/掩码/默认网关

> IP：用来标识一个网络节点（任何的联网设备）的互联网地址

A类地址：0-127；前8位网络位，后24位主机位，即网络位.主机位.主机位.主机位

B类地址：128-191；前16位网络位，后16位主机位，即网络位.网络位.主机位.主机位

C类地址：192-223；前24位网络位，后8位主机位，即网络位.网络位.网络位.主机位

D类地址：224-239；组播地址

E类地址：240-255；科研地址

私有地址范围：A类：10.0.0.0-10.255.255.255；B类：176.16.0.0-172.31.255.255；C类：192.168.0.0-192.168.255.255

> 子网掩码：用于区分IP地址和网络位与主机位

A类地址：255.0.0.0；网络位.主机位.主机位.主机位；子网掩码可以简写成8

B类地址：255.255.0.0；网络位.网络位..主机位.主机位；子网掩码可以简写成16

C类地址：255.255.255.0；网络位.网络位.网络位.主机位；子网掩码可以简写成24

> 默认网关：从一个网络通向另一个网络的关口

默认网关也是路由器、防火墙、接入服务器接口的IP地址；

相同网段可以直接通信，不需要配置默认网关；





# OSI七层

| 层           | 作用                                  | 存在        | 协议                                                         |
| :----------- | ------------------------------------- | ----------- | ------------------------------------------------------------ |
| 应用层       | 为应用程序提供网络服务                | 计算机      | HTTP超文本传输80、HTTPS安全传输443、FTP远程文件传输20/21、SMTP邮件传输25、SSH安全外壳22、DNS域名解析53、DHCP动态主机配置67 |
| 表示层       | 数据加密解密（编码解码）              |             |                                                              |
| 会话层       | 管理会话                              |             |                                                              |
| 传输层 段    | 端到端的可靠数据传输服务              | 防火墙      | TCP传输控制 6，UDP用户数据报17                               |
| 网络层包     | Ip地址寻址， 跨网段通信               | 路由器      | ICMP网际控制报文，ARP 地址解析（通过IP地址获取目标设备的MAC地址） |
| 数据链路层帧 | 使用MAC地址来访问介质，解决局域网通信 | 交换机/网卡 | MAC子层协议                                                  |
| 物理层比特   | 在设备之间传输比特流(电信号)          | 网线/网卡   |                                                              |

# tcp/ip四层

TCP**传输控制协议**，IP网际互连协议

1. 应用层（合并上三层）： HTTP，FTP,SMTP,DNS
2. 传输层： 端到端数据传输服务    ；协议：TCP传输控制，UDP用户数据报
3. 网络层： IP地址寻址，跨网段通信， 存在于路由器；IP，ICMP网际控制报文，ARP 地址解析
4. 网络接口层（合并下两层）： 局域网MAC寻址， 存在于网线/网卡 





# 封装/解封

> PUD分类

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307154346638.png" alt="image-20240307154346638" style="zoom:80%;" />



> 数据封装过程

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307154416702.png" alt="image-20240307154416702" style="zoom:80%;" />

# 数据通信过程

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307154554950.png" alt="image-20240307154554950" style="zoom:80%;" />



# 传输介质

同轴电缆、双绞线、光纤、串口电缆；

![image-20240307161639596](https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307161639596.png)

直通：两端都为同一线序；交叉：一端A一段B；



# 帧的两种格式

以太2 和IEEE802.3

![image-20240307165851382](https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307165851382.png)

区别在于：以太2帧包含type字段，标识以太帧处理后被发到哪个上层协议；IEEE802同样的位置是长度字段。

区分：看Type的16进制值数大小



# 帧结构

帧头+上三层数据+帧尾

MTU特性：数据帧的长度限制-以太2数据帧最大值 1500B ，IEEE802是1492B；上三层数据最小46B

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307170949579.png" alt="image-20240307170949579" style="zoom:67%;" />

帧头 目标MAC 6字节 12个16进制位，源MAC 6字节 12个16进制位； Type 2字节，4个二进制位；

帧尾为效验字段，检验帧传输过程中的完整性；

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307172251209.png" alt="image-20240307172251209" style="zoom: 80%;" />

> IEEE802.3

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307172426652.png" alt="image-20240307172426652" style="zoom: 80%;" />

# 数据帧的传输

通过MAC地址唯一标识网络设备，实现局域网通信。48比特

MAC由俩部分组成，分别是供应商代码和序列号。前24位为代码，由ieee管理分配，后24序列号产商分配。

---

> 传输类型

单播：单一的源端发送到单一目的端，（共享网络中，所有主机都能接收，但由于目标MAC不同，自动丢去帧）

广播：单一的源端发送到共享网络上所有主机 ，目标MAC为 FF  FF FF FF FF FF

组播：选择性广播，主机侦听特定组播地址，接收并处理目的地址为该组播的MAC地址帧；单播第一字节第八位为0，组播为1；



# 数据帧的收发

当主机收到数据帧所包含的目标MAC地址为自己时，会把以太网封装剥掉后发往上层协议；

![image-20240307185527079](https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307185527079.png)



# 交换机转发行为

泛洪：一个端口进来的数据从其他所有端口转发出去；（收到广播帧，或未知目的MAC地址的单播帧）

转发：一个端口进来的数据从另一个端口转发出去；

丢弃：直接丢弃；



# 交换机转发原理

交换机中有一个MAC地址表，里面存放了MAC地址与交换机端口的映射关系，是转发依据；

如果进入交换机的是一个单播帧，则交换机会去查MAC地址表中去查找目的MAC地址，如果查不到则泛洪，查到则比较是否和进入端口MAC相同，相同丢弃，不同转发。

如果进入的是广播帧，则不去查MAC地址表，直接泛洪

如果进入的是组播帧，

> 注意：在通信时，pc端有一个ARP表，存放的是ip对应的MAC地址， 交换机中有MAC表，存放的是端口对应的PC机的MAC地址

```shell
#查AR表
arp -a

#查MAC表
display MAC-address
```

交换机中MAC地址表的来源：交换机的学习功能，当帧进入交换机，交换机会记录这个帧的源MAC地址，并将地址与端口号映射；

---

![image-20240307204941378](https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240307204941378.png)

---

# ARP协议

属于网络层，作用是已知IP地址解析MAC地址；

> 工作原理：

1. 首先发送ARP广播，内容是我的IP是xxx，我的MAC是xxx，谁的IP是xxx，MAC地址是什么？
2. 目标主机单播回应ARP；
3. 当pc收到ARP单播回应后，在计算机中生成ARP表

---



# 命令

VRP（通用路由平台） 华为数通系列产品的操作系统平台；

---

```shell
display interface brief  #查看接口信息  brief 简略

system-view  #进入系统视图

sysname sw1 # 改名

display user-interface #查看用户登录方式 （Console，VTY）

display users #查看已登录用户信息

interface g0/0/0 # 进入接口视图

ip address 192.168.1.1 24 #配置ip 掩码
```



# 设备管理方式

> Console口管理：直接使用Console线插入Console口，由于直接插入就可以控制网络，不安全，所以配置密码

```sh
user-interface console 0 #进入Console口

authentication-mode password #配置密码
```

> Telnet远程管理 VTY ，VTY一般最大15人，若将VTY的最大登录数设0，则所有人都不能通过Telnet和SSH远程登录

```sh
user-interface vty 0 4  #进入接口

user privilege level 15  #设置权限

authentication-mode password #配置密码

telnet server enable  #开启Telnet服务（由于是全局配置，所以应该先退出端口，进入系统视图[ ]）

undo telnet server enable  #撤销Telnet服务（所有命令配置都可以添加 undo撤销）
```

**由于Telnet远程登录协议是明文传输，可以通过抓包获取密码，不安全，所以抛弃**

> SSH远程登录  配置三A（存储密码）--->关联ssh（服务）---->绑定VTY（管理）

AAA 三A，分别是认证，授权，审计

```sh
aaa  #进入AAA认证模式 （系统视图下）
local-user ajest password cipher 123456 #创建用户ajest ，密码123456
local-user ajest privilege level 15  #设置权限
local-user ajest server-type ssh  #将用户和ssh绑定，及ssh服务可以使用这个用户信息
#至此三A配置、关联ssh完毕，q退出

ssh user ajest authentication-type password #ssh服务用户认证方式设置为password认证
stelent server enable #开启ssh

user-interface vty 0 4  #进入vty接口

authentication-mode aaa #认证方式aaa

protocol inbound ssh #绑定ssh
#绑定VTY结束

#以下是远程登录
stelent 10.1.1.1  #登录 （系统视图下）
ssh client first-time enable #首次登录报错后，需要执行
```



# STP生成数协议

为提高网络可靠性，交互网络采用冗余链路：

![image-20240308110449332](https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240308110449332.png)

> **但冗余链路会带来环路危险，导致广播风暴（一直泛洪）以及MAC地址表不稳定（震荡），STP生成树协议可以解决环路问题。**

广播泛洪：在找不到目标MAC时会泛洪，其他交换机找不到再次泛洪，形成环路；

MAC地址震荡：泛洪的时候，交换机收到a端传入的目标MAC地址，形成MAC表，然后从bc端泛洪出去，循环后又从b端进来，会改写一次MAC地址表，环路后会重复改写；

---

> **STP生成树协议作用**

STP用于网络树形拓扑结构的建立，起到防止网络中的冗余链路形成环路;

STP通过阻塞端口来消除环路，并实现链路备份（当主路径故障，激活备用路径）；

> **STP生成数工作过程**

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240308114159706.png" alt="image-20240308114159706" style="zoom:80%;" />

根端口：离根交换机最近的端口；

指定端口：交换机向所连网段发送信息的端口； 根桥所有端口都是指定端口

---

根桥选举：每台交换机都认为自己是根桥并向其他交换机发送BPUD报文，比较桥ID，桥ID由16个比特位的桥优先级和48位MAC组成，优先级越高数值越小越优先，优先级相同MAC地址越小越优先；

根端口选举：选择到根桥路径开销最小的为根端口，端口带宽越高路径开销越小；如果多个累积开销相同，选择发送BID最小的端口；如果BID相同，选择PID最小的；PID由端口优先级和端口号组成，端口优先级0-240，步长16。

指定端口选举：非根交换机依据根路径开销、BID、PID，未被选举的为备用端口，阻塞

---

> **配置交换机优先级**

一般选择性能好的交换机为根桥

```sh
stp priority 4096 #配置设备优先级 0-61440

#也可以直接指定
stp root primary #指定根桥

stp root secondary #指定备用根桥
```

> **配置路径开销**

```sh
stp pathcost-standard {dotId-1988 | dotIt | legacy} #配置指定交换机上的路径开销标准

stp cost <value> #指定端口路径开销  value范围： 1-20w   1-65535  1-20000w 
```



# VLAN虚拟局域网技术

传统共享局域网从任意节点发出消息都会被发送到其他节点，形成广播域，若某时刻有多个节点发送消息会造成冲突域；

交互式局域网通过二层交换机有效隔离了冲突域，但广播域问题依然存在；

VLAN技术是将一个物理局域网在逻辑上划分多个广播域。通过在交换机上配置VLAN，可以实现同一个VLAN内的用户可以二层访问，不同VLAN用户二层隔离。避免大范围广播域。



# VLAN帧格式

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240308143131409.png" alt="image-20240308143131409" style="zoom:80%;" />

通过Tag（VLAN标签）区分不同VLAN；Tag是一种区分不同VLAN的标记，长度4比特；



# VLAN链路

VLAN链路分：Access接入链路（pc和交换机的链路） 和Trunk干道链路（交换机和交换机的链路）；Trunk链路带标签帧，接入链路不带标签；

<img src="https://typora-picgo-push.oss-cn-hangzhou.aliyuncs.com/img-for-typora/image-20240308144514237.png" alt="image-20240308144514237" style="zoom:80%;" />

---

Access端口在收到数据后会添加VLAN Tag。VLAN ID和端口的PVID相同，Access端口在转发数据前会移除VLAN Tag；

1
